PublicDateAtUSN: 2009-11-09
Candidate: CVE-2009-3555
PublicDate: 2009-11-09
References: 
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3555
 http://www.imc.org/ietf-tls/mail-archive/msg09837.html
 http://www.ietf.org/rfc/rfc5746.txt
 http://extendedsubset.com/
 http://extendedsubset.com/Renegotiating_TLS.pdf
 http://extendedsubset.com/Renegotiating_TLS_pd.pdf
 http://www.ietf.org/mail-archive/web/tls/current/msg03963.html
 http://www.links.org/?p=780
 http://www.links.org/?p=786
 http://mail-archives.apache.org/mod_mbox/httpd-announce/200911.mbox/%3C20091107013220.31376.qmail@minotaur.apache.org%3E
 https://wiki.mozilla.org/Security:Renegotiation
 https://developer.mozilla.org/NSS_3.12.6_release_notes
 http://www.ubuntu.com/usn/usn-860-1
 http://www.ubuntu.com/usn/usn-923-1
 http://www.ubuntu.com/usn/usn-927-1
 http://www.ubuntu.com/usn/usn-927-2
 http://www.ubuntu.com/usn/usn-927-3
 http://thread.gmane.org/gmane.network.gnutls.general/1838
Description:
 The TLS protocol, and the SSL protocol 3.0 and possibly earlier, as used in
 Microsoft Internet Information Services (IIS) 7.0, mod_ssl in the Apache
 HTTP Server 2.2.14 and earlier, OpenSSL before 0.9.8l, GnuTLS 2.8.5 and
 earlier, Mozilla Network Security Services (NSS) 3.12.4 and earlier,
 multiple Cisco products, and other products, does not properly associate
 renegotiation handshakes with an existing connection, which allows
 man-in-the-middle attackers to insert data into HTTPS sessions, and
 possibly other types of sessions protected by TLS or SSL, by sending an
 unauthenticated request that is processed retroactively by a server in a
 post-renegotiation context, related to a "plaintext injection" attack, aka
 the "Project Mogul" issue.
Ubuntu-Description: 
Notes: 
 jdstrand> Fixing this issue requires coordination between the IETF, SSL
  libraries (eg OpenSSL and GnuTLS) and TLS consumers (notably HTTPS servers,
  but most (or all) servers using TLS which support TLS renegotiation).
  Protocol-breaking changes are among the possibilities being
  discussed.

  The following is based on http://extendedsubset.com/Renegotiating_TLS.pdf
  and http://extendedsubset.com/Renegotiating_TLS_pd.pdf. You are encouraged to
  read this document as well as the email thread on ietf-tls for complete
  information and most up-to-date status (see References).

  There are essentially 3 types of renegotiation scenarios known at this time
  to be vulnerable, and they all require a man-in-the-middle (MITM) attack:
   1. Client certificate authentication: servers configured to require client
      certificate authentication on a per-directory basis. Apache is known
      to be vulnerable when using this configuration. There is no generally
      usable mitigation strategy known at this time.
   2. Differing server cryptographic requirements: servers configured to
      support different cipher suites within the same site. One mitigation
      strategy is to require all content on a site to use a single cipher
      suite. Disallowing specification of TLS parameters in .htaccess files
      (generally modifiable by end users) may also be a good idea.
   3. Client-initiated renegotiation: servers configured for TLS. Apache is
      known to be vulnerable when using using TLS and the client initiates a
      renegotiation. There is no generally usable mitigation strategy known at
      this time.

  The flaw should not allow the attacker to see the contents of the connection,
  and a client cannot be redirected to another site. For the HTTPS scenarios
  listed above, the attacker is able to perform arbitrary requests with the
  credentials of the victim. Arbitrary POST requests may also be possible.

  Analysis on the effects of this flaw for other protocols is ongoing.

  Until a general fix can be found for Ubuntu, users may be interested in
  reading http://www.links.org/?p=780, which has a patch to OpenSSL to disable
  all renegotiation.
 jdstrand> Update for apache2 disabled client initiated renegotiations. This
  won't fix per-Directory/Location configurations.
 mdeslaur> openssl 0.9.8l disabled renegotiations completely, with a compile
  time option to turn it back on. This may break connections to servers that
  haven't been patched. openssl 0.9.8m adds an option that applications can
  use to turn it back on:
  http://groups.google.com/group/mailing.openssl.cvs/browse_thread/thread/8d8add96fa471695
 mdeslaur> Turning renegotiation off completely may break postgresql, openvpn
  alpine, psi, fetchmail, etc.
 mdeslaur> http://www.mail-archive.com/openssl-dev@openssl.org/msg26800.html
 jdstrand> NSS 3.12.6 has support for the new renegotiation extension for TLS
  to implement rfc5746. NSS clients advertise their support for this
  extension and if the server also supports it, will be protected from this
  vulnerability. To maintain compatibility, NSS in Ubuntu will for the
  foreseeable future use the so-called 'transitional' mode which will fall back
  to the unprotected renegotiation method if the server doesn't support the
  new extension.
 jdstrand> NSS was fixed in Ubuntu 9.10 because the new Firefox required it.
  Because Firefox needs changes to take advantage of the new NSS, once Ubuntu
  8.04 LTS - 9.04 are updated to use an embedded NSS (and therefore won't use
  the system NSS), we can update the system NSS for these releases.
 jdstrand> When upgrading the system NSS on Ubuntu 8.04 LTS - 9.04, be careful
  about https://launchpad.net/bugs/559881 and https://launchpad.net/bugs/559918
  (regressions seen with the 9.10 update).
 jdstrand> postgresql 8.1.20, 8.3.10 and 8.4.3 now have ssl_renegotiation_limit
  to control session key renegotiation
 jdstrand> preliminary GNUtls patches at (in 2.9.10 development release):
  http://thread.gmane.org/gmane.comp.encryption.gpg.gnutls.devel/3944
  http://git.savannah.gnu.org/gitweb/?p=gnutls.git&a=search&h=HEAD&st=commit&s=renegotiation
Bugs: 
 https://bugs.edge.launchpad.net/ubuntu/+source/openssl/+bug/484417
 http://rt.openssl.org/Ticket/Display.html?user=guest&pass=guest&id=2105
 http://rt.openssl.org/index.html?q=2102
 https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2009-3555
 https://bugzilla.redhat.com/show_bug.cgi?id=537962
 https://bugzilla.redhat.com/show_bug.cgi?id=538373
 https://bugzilla.redhat.com/show_bug.cgi?id=538456
 https://bugzilla.redhat.com/show_bug.cgi?id=533234
 https://bugs.launchpad.net/ubuntu/+source/nss/+bug/562332
 https://bugzilla.redhat.com/show_bug.cgi?id=533125
Priority: medium
Discovered-by: Marsh Ray, Steve Dispensa
Assigned-to: jdstrand

Patches_openssl:
upstream_openssl: needed
dapper_openssl: needed
hardy_openssl: needed
intrepid_openssl: needed
jaunty_openssl: needed
karmic_openssl: needed
devel_openssl: needed

Patches_apache2:
 vendor: http://www.mandriva.com/en/security/advisories?name=MDVSA-2009:295
upstream_apache2: released (2.2.14-2)
dapper_apache2: released (2.0.55-4ubuntu2.9)
hardy_apache2: released (2.2.8-1ubuntu0.14)
intrepid_apache2: released (2.2.9-7ubuntu3.5)
jaunty_apache2: released (2.2.11-2ubuntu2.5)
karmic_apache2: released (2.2.12-1ubuntu2.1)
devel_apache2: released (2.2.14-2ubuntu1)

Patches_gnutls12:
 vendor: https://rhn.redhat.com/errata/RHSA-2010-0166.html
upstream_gnutls12: needed
dapper_gnutls12: needed
hardy_gnutls12: DNE
intrepid_gnutls12: DNE
jaunty_gnutls12: DNE
karmic_gnutls12: DNE
devel_gnutls12: DNE

Patches_gnutls13:
upstream_gnutls13: needed
dapper_gnutls13: DNE
hardy_gnutls13: needed
intrepid_gnutls13: DNE
jaunty_gnutls13: DNE
karmic_gnutls13: DNE
devel_gnutls13: DNE

Patches_gnutls26: upstream (2.9.10)
upstream_gnutls26: needed
dapper_gnutls26: DNE
hardy_gnutls26: DNE
intrepid_gnutls26: needed
jaunty_gnutls26: needed
karmic_gnutls26: needed
devel_gnutls26: needed

Patches_libapache-mod-ssl:
upstream_libapache-mod-ssl: needs-triage
dapper_libapache-mod-ssl: ignored (reached end-of-life)
hardy_libapache-mod-ssl: DNE
intrepid_libapache-mod-ssl: DNE
jaunty_libapache-mod-ssl: DNE
karmic_libapache-mod-ssl: DNE
devel_libapache-mod-ssl: DNE

Patches_openjdk-6:
upstream_openjdk-6: released (6b18~pre4-1)
dapper_openjdk-6: DNE
hardy_openjdk-6: released (6b11-2ubuntu2.2)
intrepid_openjdk-6: released (6b12-0ubuntu6.7)
jaunty_openjdk-6: released (6b14-1.4.1-0ubuntu13)
karmic_openjdk-6: released (6b16-1.6.1-3ubuntu3)
devel_openjdk-6: not-affected (6b18~pre4-0ubuntu1)

Patches_nss:
upstream_nss: released (3.12.6)
dapper_nss: DNE
hardy_nss: needed
intrepid_nss: needed
jaunty_nss: needed
karmic_nss: released (3.12.6-0ubuntu0.9.10.1)
devel_nss: released (3.12.6-0ubuntu2)

