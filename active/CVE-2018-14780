PublicDateAtUSN: 2018-08-15 18:29:00 UTC
Candidate: CVE-2018-14780
PublicDate: 2018-08-15 18:29:00 UTC
References:
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-14780
 https://www.x41-dsec.de/lab/advisories/x41-2018-001-Yubico-Piv/
 https://usn.ubuntu.com/usn/usn-4276-1
Description:
 An out-of-bounds read issue was discovered in the Yubico-Piv 1.5.0
 smartcard driver. The file lib/ykpiv.c contains the following code in the
 function `_ykpiv_fetch_object()`: {% highlight c %} if(sw == SW_SUCCESS) {
 size_t outlen; int offs = _ykpiv_get_length(data + 1, &outlen); if(offs ==
 0) { return YKPIV_SIZE_ERROR; } memmove(data, data + 1 + offs, outlen);
 *len = outlen; return YKPIV_OK; } else { return YKPIV_GENERIC_ERROR; } {%
 endhighlight %} -- in the end, a `memmove()` occurs with a length retrieved
 from APDU data. This length is not checked for whether it is outside of the
 APDU data retrieved. Therefore the `memmove()` could copy bytes behind the
 allocated data buffer into this buffer.
Ubuntu-Description:
 It was discovered that libykpiv, a supporting library of the Yubico PIV
 tool and YubiKey PIV Manager, mishandled specially crafted input. An attacker
 with a custom-made, malicious USB device could potentially execute arbitrary
 code on a computer running the Yubico PIV Tool or Yubikey PIV Manager.
Notes:
Bugs:
 http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=906128
Priority: high
Discovered-by:
Assigned-to:
CVSS: 


Patches_yubico-piv-tool:
upstream_yubico-piv-tool: released (1.6.1-1)
precise/esm_yubico-piv-tool: DNE
trusty_yubico-piv-tool: DNE
trusty/esm_yubico-piv-tool: DNE
xenial_yubico-piv-tool: needed
bionic_yubico-piv-tool: released (1.4.2-2ubuntu0.1)
cosmic_yubico-piv-tool: ignored (reached end-of-life)
disco_yubico-piv-tool: ignored (reached end-of-life)
eoan_yubico-piv-tool: not-affected (1.7.0-1)
devel_yubico-piv-tool: not-affected (1.7.0-1)
