PublicDateAtUSN: 2019-12-10
Candidate: CVE-2019-14861
CRD: 2019-12-10
PublicDate: 2019-12-10 23:15:00 UTC
References: 
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-14861
 https://www.samba.org/samba/security/CVE-2019-14861.html
 https://usn.ubuntu.com/usn/usn-4217-1
 https://usn.ubuntu.com/usn/usn-4217-2
Description:
 All Samba versions 4.x.x before 4.9.17, 4.10.x before 4.10.11 and 4.11.x
 before 4.11.3 have an issue, where the (poorly named) dnsserver RPC pipe
 provides administrative facilities to modify DNS records and zones. Samba,
 when acting as an AD DC, stores DNS records in LDAP. In AD, the default
 permissions on the DNS partition allow creation of new records by
 authenticated users. This is used for example to allow machines to
 self-register in DNS. If a DNS record was created that case-insensitively
 matched the name of the zone, the ldb_qsort() and dns_name_compare()
 routines could be confused into reading memory prior to the list of DNS
 entries when responding to DnssrvEnumRecords() or DnssrvEnumRecords2() and
 so following invalid memory as a pointer.
Ubuntu-Description: 
Notes: 
Mitigation: 
Bugs: 
 https://bugzilla.samba.org/show_bug.cgi?id=14138
Priority: medium
Discovered-by: Andreas Oster
Assigned-to: mdeslaur
CVSS:
 nvd: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H


Patches_samba:
upstream_samba: released (4.11.3,4.10.11,4.9.17)
precise/esm_samba: not-affected
trusty_samba: ignored (out of standard support)
trusty/esm_samba: released (2:4.3.11+dfsg-0ubuntu0.14.04.20+esm4)
xenial_samba: released (2:4.3.11+dfsg-0ubuntu0.16.04.24)
bionic_samba: released (2:4.7.6+dfsg~ubuntu-0ubuntu2.14)
disco_samba: released (2:4.10.0+dfsg-0ubuntu2.7)
eoan_samba: released (2:4.10.7+dfsg-0ubuntu2.3)
devel_samba: pending (2:4.11.5+dfsg-1ubuntu1)
