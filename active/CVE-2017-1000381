PublicDateAtUSN: 2017-07-07
Candidate: CVE-2017-1000381
PublicDate: 2017-07-07 17:29:00 UTC
References:
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-1000381
 https://c-ares.haxx.se/adv_20170620.html
 https://usn.ubuntu.com/usn/usn-3395-1
Description:
 The c-ares function `ares_parse_naptr_reply()`, which is used for parsing
 NAPTR responses, could be triggered to read memory outside of the given
 input buffer if the passed in DNS response packet was crafted in a
 particular way.
Ubuntu-Description:
 It was discovered that c-ares incorrectly handled certain NAPTR responses. A
 remote attacker could possibly use this issue to cause applications using
 c-ares to crash, resulting in a denial of service.
Notes:
Bugs:
 http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=865360
Priority: medium
Discovered-by:
Assigned-to: mdeslaur (c-ares), mikesalvatore (nodejs)
CVSS: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N

Patches_c-ares:
 upstream: https://c-ares.haxx.se/CVE-2017-1000381.patch
upstream_c-ares: released (1.13.0,1.12.0-4)
precise/esm_c-ares: DNE
trusty_c-ares: released (1.10.0-2ubuntu0.2)
trusty/esm_c-ares: DNE (trusty was released [1.10.0-2ubuntu0.2])
vivid/ubuntu-core_c-ares: DNE
xenial_c-ares: released (1.10.0-3ubuntu0.2)
yakkety_c-ares: ignored (reached end-of-life)
zesty_c-ares: released (1.12.0-1ubuntu0.1)
bionic_c-ares: not-affected (1.12.0-4)
cosmic_c-ares: not-affected (1.12.0-4)
disco_c-ares: not-affected (1.12.0-4)
eoan_c-ares: not-affected (1.12.0-4)
devel_c-ares: not-affected (1.12.0-4)

Patches_nodejs:
 upstream: https://github.com/nodejs/node/commit/80fe2662e4
upstream_nodejs: released (4.8.4, 6.11.1, 8.1.4)
precise/esm_nodejs: DNE
trusty_nodejs: not-affected (uses system ares)
trusty/esm_nodejs: not-affected (uses system ares)
xenial_nodejs: needed

bionic_nodejs: not-affected (8.1.4)
cosmic_nodejs: not-affected (8.1.4)
disco_nodejs: not-affected (8.1.4)
eoan_nodejs: not-affected (8.1.4)
devel_nodejs: not-affected (8.1.4)
