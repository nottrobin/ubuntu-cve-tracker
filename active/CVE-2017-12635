Candidate: CVE-2017-12635
PublicDate: 2017-11-14
References:
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-12635
 http://www.openwall.com/lists/oss-security/2017/11/14/6
 https://lists.apache.org/thread.html/6c405bf3f8358e6314076be9f48c89a2e0ddf00539906291ebdf0c67@%3Cdev.couchdb.apache.org%3E
Description:
 Due to differences in the Erlang-based JSON parser and JavaScript-based
 JSON parser, it is possible in Apache CouchDB before 1.7.0 and 2.x before
 2.1.1 to submit _users documents with duplicate keys for 'roles' used for
 access control within the database, including the special case '_admin'
 role, that denotes administrative users. In combination with CVE-2017-12636
 (Remote Code Execution), this can be used to give non-admin users access to
 arbitrary shell commands on the server as the database system user. The
 JSON parser differences result in behaviour that if two 'roles' keys are
 available in the JSON, the second one will be used for authorising the
 document write, but the first 'roles' key is used for subsequent
 authorization for the newly created user. By design, users can not assign
 themselves roles. The vulnerability allows non-admin users to give
 themselves admin privileges.
Ubuntu-Description:
Notes:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:


Patches_couchdb:
upstream_couchdb: released (1.7.0)
precise/esm_couchdb: DNE
trusty_couchdb: needed
xenial_couchdb: needed
zesty_couchdb: ignored (reached end-of-life)
artful_couchdb: ignored (reached end-of-life)
bionic_couchdb: DNE
cosmic_couchdb: DNE
disco_couchdb: DNE
devel_couchdb: DNE
