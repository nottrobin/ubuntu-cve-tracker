Candidate: CVE-2020-5291
PublicDate: 2020-03-31 18:15:00 UTC
References:
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-5291
 https://github.com/containers/bubblewrap/security/advisories/GHSA-j2qp-rvxj-43vj
Description:
 Bubblewrap (bwrap) before version 0.4.1, if installed in setuid mode and
 the kernel supports unprivileged user namespaces, then the `bwrap
 --userns2` option can be used to make the setuid process keep running as
 root while being traceable. This can in turn be used to gain root
 permissions. Note that this only affects the combination of bubblewrap in
 setuid mode (which is typically used when unprivileged user namespaces are
 not supported) and the support of unprivileged user namespaces. Known to be
 affected are: * Debian testing/unstable, if unprivileged user namespaces
 enabled (not default) * Debian buster-backports, if unprivileged user
 namespaces enabled (not default) * Arch if using `linux-hardened`, if
 unprivileged user namespaces enabled (not default) * Centos 7 flatpak COPR,
 if unprivileged user namespaces enabled (not default) This has been fixed
 in the 0.4.1 release, and all affected users should update.
Ubuntu-Description:
Notes:
 sarnold> Bubblewrap isn't installed setuid by default on Ubuntu
 mdeslaur> introduced in 0.4.0
Mitigation:
Bugs:
 http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=955441
Priority: low
Discovered-by:
Assigned-to: mdeslaur
CVSS:


Patches_bubblewrap:
 upstream: https://github.com/containers/bubblewrap/commit/1f7e2ad948c051054b683461885a0215f1806240
upstream_bubblewrap: released (0.4.1-1)
precise/esm_bubblewrap: DNE
trusty_bubblewrap: ignored (out of standard support)
trusty/esm_bubblewrap: DNE
xenial_bubblewrap: DNE
bionic_bubblewrap: not-affected (code not present)
eoan_bubblewrap: not-affected (code not present)
devel_bubblewrap: needed
