PublicDateAtUSN: 2011-08-09
Candidate: CVE-2011-1833
PublicDate: 2011-08-09
References: 
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-1833
 http://www.ubuntu.com/usn/usn-1188-1
Description: 
 check_ownerships() function doesn't work as it should because of a race condition. Arguments of both mount() and umount() calls can be changed between the check and the usage. This may lead to arbitrary mount point umounting or probably to gaining ability to try passphrases of otherpeople's ecryptfs storages.
 
 lock_counter() is also racy. It (1) tries to check existance and ownership of the file before open(), (2) neither use stat() instead of lstat() nor O_NOFOLLOW, (3) is not protected against deletion of the lock file by the owner. The lock file should be probably created in root only writable directory before dropping EUID.
Ubuntu-Description: 
Notes: 
 mdeslaur> There are two parts to this fix, 1- kernel fix, 2- userspace fix
Bugs:
 https://launchpad.net/bugs/732628
Priority: low
Discovered-by: Vasiliy Kulikov and Dan Rosenberg
Assigned-to: 

Patches_ecryptfs-utils:
upstream_ecryptfs-utils: needs-triage
hardy_ecryptfs-utils: not-affected (code not present)
lucid_ecryptfs-utils: released (83-0ubuntu3.2.10.04.1)
maverick_ecryptfs-utils: released (83-0ubuntu3.2.10.10.1)
natty_ecryptfs-utils: released (87-0ubuntu1.1)
devel_ecryptfs-utils: released (89-0ubuntu2)

Patches_linux:
 break-fix: 237fead619984cc48818fe12ee0ceada3f55b012 764355487ea220fdc2faf128d577d7f679b91f97
upstream_linux: pending
hardy_linux: needed
lucid_linux: needed
maverick_linux: needed
natty_linux: needed
devel_linux: needed

Patches_linux-ec2:
upstream_linux-ec2: pending
hardy_linux-ec2: DNE
lucid_linux-ec2: needed
maverick_linux-ec2: ignored (binary supplied by "linux" now)
natty_linux-ec2: DNE
devel_linux-ec2: DNE

Patches_linux-mvl-dove:
upstream_linux-mvl-dove: pending
hardy_linux-mvl-dove: DNE
lucid_linux-mvl-dove: needed
maverick_linux-mvl-dove: needed
natty_linux-mvl-dove: DNE
devel_linux-mvl-dove: DNE

Patches_linux-ti-omap4:
upstream_linux-ti-omap4: pending
hardy_linux-ti-omap4: DNE
lucid_linux-ti-omap4: DNE
maverick_linux-ti-omap4: needed
natty_linux-ti-omap4: needed
devel_linux-ti-omap4: needed

Patches_linux-lts-backport-maverick:
upstream_linux-lts-backport-maverick: pending
hardy_linux-lts-backport-maverick: DNE
lucid_linux-lts-backport-maverick: needed
maverick_linux-lts-backport-maverick: DNE
natty_linux-lts-backport-maverick: DNE
devel_linux-lts-backport-maverick: DNE

Patches_linux-fsl-imx51:
upstream_linux-fsl-imx51: pending
hardy_linux-fsl-imx51: DNE
lucid_linux-fsl-imx51: needed
maverick_linux-fsl-imx51: DNE
natty_linux-fsl-imx51: DNE
devel_linux-fsl-imx51: DNE

Patches_linux-lts-backport-natty:
upstream_linux-lts-backport-natty: pending
hardy_linux-lts-backport-natty: DNE
lucid_linux-lts-backport-natty: needed
maverick_linux-lts-backport-natty: DNE
natty_linux-lts-backport-natty: DNE
devel_linux-lts-backport-natty: DNE
