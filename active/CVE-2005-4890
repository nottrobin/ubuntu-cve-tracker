Candidate: CVE-2005-4890
PublicDate: 2019-11-04 19:15:00 UTC
References: 
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-4890
 http://www.openwall.com/lists/oss-security/2011/06/02/3
 http://www.openwall.com/lists/oss-security/2012/11/05/8
 http://www.ush.it/2009/01/06/25c3-ccc-congress-2008-tricks-makes-you-smile/
 http://www.redhat.com/archives/fedora-devel-list/2004-July/msg01314.html
Description:
 There is a possible tty hijacking in shadow 4.x before 4.1.5 and sudo 1.x
 before 1.7.4 via "su - user -c program". The user session can be escaped to
 the parent session by using the TIOCSTI ioctl to push characters into the
 input buffer to be read by the next process.
Ubuntu-Description: 
Notes: 
 mdeslaur> sudo is also apprently vulnerable to this, so the use_pty
 mdeslaur> option was added. We need to verify versions, and make sure
 mdeslaur> it is actually getting honored (apparently the option wasn't
 mdeslaur> working: http://www.openwall.com/lists/oss-security/2011/06/22/4)
 jdstrand> sudo in 12.04 and higher has the fix for use_pty. A small patch
  (http://www.sudo.ws/repos/sudo/rev/8d95a163dfc1) can be used to enable it
  on Ubuntu 11.04 and 11.10.
 mdeslaur> Please note that use_pty is not enabled by default in sudo, it
 mdeslaur> must be specifically enabled.
 sarnold> su interactive has the same problem, no fix known on 20130305
Bugs: 
 http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=262454
 http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=628843 (shadow)
 https://bugzilla.redhat.com/show_bug.cgi?id=710208
 https://bugzilla.redhat.com/show_bug.cgi?id=173008
 https://bugzilla.redhat.com/show_bug.cgi?id=199066
 https://bugzilla.redhat.com/show_bug.cgi?id=479145
 http://www.sudo.ws/bugs/show_bug.cgi?id=142
Priority: low
Discovered-by:
Assigned-to: 
CVSS: 

Patches_shadow:
upstream_shadow: released (1:4.1.5-1)
hardy_shadow: ignored (reached end-of-life)
lucid_shadow: ignored (reached end-of-life)
maverick_shadow: ignored (reached end-of-life)
natty_shadow: ignored (reached end-of-life)
oneiric_shadow: ignored (reached end-of-life)
precise_shadow: ignored (reached end-of-life)
precise/esm_shadow: needed
quantal_shadow: ignored (reached end-of-life)
raring_shadow: ignored (reached end-of-life)
saucy_shadow: ignored (reached end-of-life)
trusty_shadow: not-affected (1:4.1.5.1-1ubuntu9)
trusty/esm_shadow: not-affected (1:4.1.5.1-1ubuntu9)
utopic_shadow: not-affected
vivid_shadow: not-affected
vivid/stable-phone-overlay_shadow: not-affected
vivid/ubuntu-core_shadow: not-affected
wily_shadow: not-affected
xenial_shadow: not-affected
yakkety_shadow: not-affected
zesty_shadow: not-affected
artful_shadow: not-affected
bionic_shadow: not-affected
cosmic_shadow: not-affected
disco_shadow: not-affected
eoan_shadow: not-affected
devel_shadow: not-affected

Patches_sudo:
 upstream: http://www.sudo.ws/repos/sudo/rev/aea971f1456a (pt1)
 upstream: http://www.sudo.ws/repos/sudo/rev/e7b167f8a6e5 (pt2)
 upstream: http://www.sudo.ws/repos/sudo/rev/26120a59c20e (pt3)
 upstream: http://www.sudo.ws/repos/sudo/rev/8d95a163dfc1 (pt4)
upstream_sudo: released (1.8.2)
hardy_sudo: ignored (reached end-of-life)
lucid_sudo: ignored (reached end-of-life)
maverick_sudo: ignored (reached end-of-life)
natty_sudo: ignored (reached end-of-life)
oneiric_sudo: ignored (reached end-of-life)
precise_sudo: not-affected (1.8.3p2-1ubuntu2)
precise/esm_sudo: not-affected (1.8.3p2-1ubuntu2)
quantal_sudo: not-affected
raring_sudo: not-affected
saucy_sudo: not-affected
trusty_sudo: not-affected
trusty/esm_sudo: not-affected
utopic_sudo: not-affected
vivid_sudo: not-affected
vivid/stable-phone-overlay_sudo: not-affected
vivid/ubuntu-core_sudo: not-affected
wily_sudo: not-affected
xenial_sudo: not-affected
yakkety_sudo: not-affected
zesty_sudo: not-affected
artful_sudo: not-affected
bionic_sudo: not-affected
cosmic_sudo: not-affected
disco_sudo: not-affected
eoan_sudo: not-affected
devel_sudo: not-affected
