Candidate: CVE-2018-12029
PublicDate: 2018-06-17 20:29:00 UTC
References:
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-12029
 https://blog.phusion.nl/2018/06/12/passenger-5-3-2-various-security-fixes/
 https://github.com/phusion/passenger/commit/207870f5b7f5cc240587ab0977d6046782ae1d86
 https://blog.phusion.nl/passenger-5-3-2
 https://pulsesecurity.co.nz/advisories/phusion-passenger-priv-esc
Description:
 A race condition in the nginx module in Phusion Passenger 3.x through 5.x
 before 5.3.2 allows local escalation of privileges when a non-standard
 passenger_instance_registry_dir with insufficiently strict permissions is
 configured. Replacing a file with a symlink after the file was created, but
 before it was chowned, leads to the target of the link being chowned via
 the path. Targeting sensitive files such as root's crontab file allows
 privilege escalation.
Ubuntu-Description:
Notes:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS: CVSS:3.0/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H


Patches_passenger:
upstream_passenger: released (5.0.30-1.1)
precise/esm_passenger: DNE
trusty_passenger: DNE
trusty/esm_passenger: DNE
xenial_passenger: needs-triage
artful_passenger: ignored (reached end-of-life)
bionic_passenger: released (5.0.30-1+deb9u1build0.18.04.1)
cosmic_passenger: released (5.0.30-1+deb9u1build0.18.10.1)
disco_passenger: released (5.0.30-1+deb9u1build0.19.04.1)
eoan_passenger: not-affected (5.0.30-1.1)
devel_passenger: not-affected (5.0.30-1.1)

Patches_ruby-passenger:
upstream_ruby-passenger: needs-triage
precise/esm_ruby-passenger: DNE
trusty_ruby-passenger: ignored (reached end-of-life)
trusty/esm_ruby-passenger: DNE (trusty was needs-triage)
xenial_ruby-passenger: DNE
artful_ruby-passenger: DNE
bionic_ruby-passenger: DNE
cosmic_ruby-passenger: DNE
disco_ruby-passenger: DNE
eoan_ruby-passenger: DNE
devel_ruby-passenger: DNE
