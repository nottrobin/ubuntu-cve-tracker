PublicDateAtUSN: 2017-03-02
Candidate: CVE-2015-8994
PublicDate: 2017-03-02 06:59:00 UTC
References:
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-8994
 https://usn.ubuntu.com/usn/usn-3382-1
Description:
 An issue was discovered in PHP 5.x and 7.x, when the configuration uses
 apache2handler/mod_php or php-fpm with OpCache enabled. With 5.x after
 5.6.28 or 7.x after 7.0.13, the issue is resolved in a non-default
 configuration with the opcache.validate_permission=1 setting. The
 vulnerability details are as follows. In PHP SAPIs where PHP interpreters
 share a common parent process, Zend OpCache creates a shared memory object
 owned by the common parent during initialization. Child PHP processes
 inherit the SHM descriptor, using it to cache and retrieve compiled script
 bytecode ("opcode" in PHP jargon). Cache keys vary depending on
 configuration, but filename is a central key component, and compiled opcode
 can generally be run if a script's filename is known or can be guessed.
 Many common shared-hosting configurations change EUID in child processes to
 enforce privilege separation among hosted users (for example using
 mod_ruid2 for the Apache HTTP Server, or php-fpm user settings). In these
 scenarios, the default Zend OpCache behavior defeats script file
 permissions by sharing a single SHM cache among all child PHP processes.
 PHP scripts often contain sensitive information: Think of CMS
 configurations where reading or running another user's script usually means
 gaining privileges to the CMS database.
Ubuntu-Description:
Notes:
 sbeattie> PEAR issues should go against php-pear as of xenial
 tyhicks> PHP7 < 7.0.14 and PHP5 < 5.6.29 are affected
Bugs:
 https://bugs.php.net/bug.php?id=69090
Priority: low
Discovered-by:
Assigned-to:

Patches_php5:
 upstream: https://github.com/php/php-src/commit/ecba563f2fa1e027ea91b9ee0d50611273852995
 upstream: https://github.com/php/php-src/commit/8202b970777b84d57c590b78f9b6572ef0e0c205
 upstream: https://github.com/php/php-src/commit/9849c97b1bdfd7f0a7c499cad4cf601ebd68cc22
upstream_php5: needs-triage
precise_php5: not-affected (code not present)
precise/esm_php5: not-affected (code not present)
trusty_php5: released (5.5.9+dfsg-1ubuntu4.22)
vivid/ubuntu-core_php5: DNE
vivid/stable-phone-overlay_php5: DNE
xenial_php5: DNE
yakkety_php5: DNE
zesty_php5: DNE
devel_php5: DNE

Patches_php7.0:
 upstream: http://git.php.net/?p=php-src.git;a=commit;h=ecba563f2fa1e027ea91b9ee0d50611273852995
upstream_php7.0: released (7.0.14-1)
precise_php7.0: DNE
precise/esm_php7.0: DNE
trusty_php7.0: DNE
vivid/ubuntu-core_php7.0: DNE
vivid/stable-phone-overlay_php7.0: DNE
xenial_php7.0: not-affected (7.0.15-0ubuntu0.16.04.2)
yakkety_php7.0: not-affected
zesty_php7.0: not-affected
devel_php7.0: DNE

Patches_php7.1:
upstream_php7.1: released (7.1.1-1)
precise_php7.1: DNE
precise/esm_php7.1: DNE
trusty_php7.1: DNE
vivid/ubuntu-core_php7.1: DNE
vivid/stable-phone-overlay_php7.1: DNE
xenial_php7.1: DNE
yakkety_php7.1: DNE
zesty_php7.1: DNE
devel_php7.1: not-affected (7.1.4-2ubuntu1)
