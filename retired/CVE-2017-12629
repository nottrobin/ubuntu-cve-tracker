PublicDateAtUSN: 2017-10-14 23:29:00 UTC
Candidate: CVE-2017-12629
PublicDate: 2017-10-14 23:29:00 UTC
References:
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-12629
 https://bugzilla.redhat.com/show_bug.cgi?id=1501529
 http://mail-archives.apache.org/mod_mbox/lucene-dev/201710.mbox/%3CCAKrJsP=twErMhzf+FtUMOpCk7+r0pK35hAqoqf_ZtvEoshTgjQ@mail.gmail.com%3E
 https://usn.ubuntu.com/usn/usn-4259-1
Description:
 Remote code execution occurs in Apache Solr before 7.1 with Apache Lucene
 before 7.1 by exploiting XXE in conjunction with use of a Config API
 add-listener command to reach the RunExecutableListener class.
 Elasticsearch, although it uses Lucene, is NOT vulnerable to this. Note
 that the XML external entity expansion vulnerability occurs in the XML
 Query Parser which is available, by default, for any query request with
 parameters deftype=xmlparser and can be exploited to upload malicious data
 to the /upload request handler or as Blind XXE using ftp wrapper in order
 to read arbitrary local files from the Solr server. Note also that the
 second vulnerability relates to remote code execution using the
 RunExecutableListener available on all affected versions of Solr.
Ubuntu-Description:
 Michael Stepankin and Olga Barinova discovered that Apache Lucene was
 vulnerable to an XXE attack. An attacker could use this vulnerability to
 remotely execute code.
Notes:
Bugs:
Priority: high
Discovered-by: Michael Stepankin and Olga Barinova
Assigned-to:
CVSS: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H


Patches_lucene-solr:
upstream_lucene-solr: needed
precise/esm_lucene-solr: DNE
trusty_lucene-solr: ignored (reached end-of-life)
trusty/esm_lucene-solr: DNE (trusty was needed)
vivid/ubuntu-core_lucene-solr: DNE
xenial_lucene-solr: released (3.6.2+dfsg-8ubuntu0.1)
zesty_lucene-solr: ignored (reached end-of-life)
artful_lucene-solr: released (3.6.2+dfsg-10+deb9u1build0.17.10.1)
bionic_lucene-solr: not-affected (3.6.2+dfsg-11)
cosmic_lucene-solr: not-affected (3.6.2+dfsg-11)
disco_lucene-solr: not-affected (3.6.2+dfsg-11)
eoan_lucene-solr: not-affected (3.6.2+dfsg-11)
devel_lucene-solr: not-affected (3.6.2+dfsg-11)
