Candidate: CVE-2012-4454
PublicDate: 2012-10-10 18:55:00 UTC
References:
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-4454
 http://www.openwall.com/lists/oss-security/2012/09/07/2
 http://www.openwall.com/lists/oss-security/2012/09/27/2
Description:
 openCryptoki before 2.4.1, when using spinlocks, allows local users to
 create or set world-writable permissions on arbitrary files via a symlink
 attack on the (1) .pkapi_xpk or (2) .pkcs11spinloc file in /tmp.
Ubuntu-Description:
Notes:
 mdeslaur> members of the pkcs11 group are considered trusted by upstream
 mdeslaur> and can escalate privileges to root even after the upstream
 mdeslaur> patches. See oss-security discussion.
 mdeslaur> Moving this to /var/lock/opencryptoki makes the problem worse
 mdeslaur> for members of the pkcs11 group as that directory wouldn't be
 mdeslaur> covered by symlink restrictions. Fix shouldn't be applied to
 mdeslaur> natty+
 mdeslaur> Fixing this in lucid would only prevent users who are not in
 mdeslaur> the pkcs11 group from escalating permissions. Since it is likely
 mdeslaur> that local users that have this installed are in that group,
 mdeslaur> this is downgraded to low.
Bugs:
 http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=689417
Priority: low
Discovered-by: Niels Heinen
Assigned-to:
CVSS: 

Patches_opencryptoki:
 upstream:http://opencryptoki.git.sourceforge.net/git/gitweb.cgi?p=opencryptoki/opencryptoki;a=commitdiff;h=b7fcb3eb0319183348f1f4fb90ede4edd6487c30 (pt1)
 upstream:http://opencryptoki.git.sourceforge.net/git/gitweb.cgi?p=opencryptoki/opencryptoki;a=commitdiff;h=58345488c9351d9be9a4be27c8b407c2706a33a9 (pt2)
 upstream:http://opencryptoki.git.sourceforge.net/git/gitweb.cgi?p=opencryptoki/opencryptoki;a=commitdiff;h=8a63b3b17d34718d0f8c7525f93b5eb3c623076a (pt3)
 upstream:http://opencryptoki.git.sourceforge.net/git/gitweb.cgi?p=opencryptoki/opencryptoki;a=commitdiff;h=5667edb52cd27b7e512f48f823b4bcc6b872ab15 (pt4)
upstream_opencryptoki: released (2.4.2)
hardy_opencryptoki: ignored (reached end-of-life)
lucid_opencryptoki: ignored (reached end-of-life)
natty_opencryptoki: ignored (reached end-of-life)
oneiric_opencryptoki: ignored (reached end-of-life)
precise_opencryptoki: ignored (reached end-of-life)
precise/esm_opencryptoki: DNE (precise was needed)
quantal_opencryptoki: ignored (reached end-of-life)
raring_opencryptoki: ignored (reached end-of-life)
saucy_opencryptoki: ignored (reached end-of-life)
trusty_opencryptoki: ignored (reached end-of-life)
trusty/esm_opencryptoki: DNE (trusty was needed)
utopic_opencryptoki: ignored (reached end-of-life)
vivid_opencryptoki: ignored (reached end-of-life)
vivid/stable-phone-overlay_opencryptoki: DNE
vivid/ubuntu-core_opencryptoki: ignored (reached end-of-life)
wily_opencryptoki: ignored (reached end-of-life)
xenial_opencryptoki: not-affected (3.4.1+dfsg-1)
yakkety_opencryptoki: ignored (reached end-of-life)
zesty_opencryptoki: ignored (reached end-of-life)
artful_opencryptoki: ignored (reached end-of-life)
bionic_opencryptoki: not-affected (3.4.1+dfsg-1)
cosmic_opencryptoki: not-affected (3.4.1+dfsg-1)
disco_opencryptoki: not-affected (3.4.1+dfsg-1)
devel_opencryptoki: not-affected (3.4.1+dfsg-1)
Tags_opencryptoki_natty: symlink-restriction
Tags_opencryptoki_oneiric: symlink-restriction
Tags_opencryptoki_precise: symlink-restriction
Tags_opencryptoki_devel: symlink-restriction
