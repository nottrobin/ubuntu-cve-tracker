PublicDateAtUSN: 2013-01-10
Candidate: CVE-2013-0422
PublicDate: 2013-01-10 21:55:00 UTC
References: 
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-0422
 http://www.kb.cert.org/vuls/id/625617
 http://blog.fireeye.com/research/2013/01/happy-new-year-from-new-java-zero-day.html
 http://krebsonsecurity.com/2013/01/zero-day-java-exploit-debuts-in-crimeware/
 http://labs.alienvault.com/labs/index.php/2013/new-year-new-java-zeroday/
 http://malware.dontneedcoffee.com/2013/01/0-day-17u10-spotted-in-while-disable.html
 https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/multi/browser/java_jre17_jmxbean.rb
 https://github.com/rapid7/metasploit-framework/tree/master/data/exploits/cve-2013-0422
 http://pastebin.com/cUG2ayjh
 http://www.reddit.com/r/netsec/comments/16b4n1/0day_exploit_fo_java_17u10_spotted_in_the_wild/c7ulpd7
 http://www.oracle.com/technetwork/java/javase/7u11-relnotes-1896856.html
 https://blogs.oracle.com/security/entry/security_alert_for_cve_2013
 https://usn.ubuntu.com/usn/usn-1693-1
Description:
 Multiple vulnerabilities in Oracle Java 7 before Update 11 allow remote
 attackers to execute arbitrary code by (1) using the public
 getMBeanInstantiator method in the JmxMBeanServer class to obtain a
 reference to a private MBeanInstantiator object, then retrieving arbitrary
 Class references using the findClass method, and (2) using the Reflection
 API with recursion in a way that bypasses a security check by the
 java.lang.invoke.MethodHandles.Lookup.checkSecurityManager method due to
 the inability of the sun.reflect.Reflection.getCallerClass method to skip
 frames related to the new reflection API, as exploited in the wild in
 January 2013, as demonstrated by Blackhole and Nuclear Pack, and a
 different vulnerability than CVE-2012-4681 and CVE-2012-3174. NOTE: some
 parties have mapped the recursive Reflection API issue to CVE-2012-3174,
 but CVE-2012-3174 is for a different vulnerability whose details are not
 public as of 20130114.  CVE-2013-0422 covers both the JMX/MBean and
 Reflection API issues.  NOTE: it was originally reported that Java 6 was
 also vulnerable, but the reporter has retracted this claim, stating that
 Java 6 is not exploitable because the relevant code is called in a way that
 does not bypass security checks.  NOTE: as of 20130114, a reliable third
 party has claimed that the findClass/MBeanInstantiator vector was not fixed
 in Oracle Java 7 Update 11.  If there is still a vulnerable condition, then
 a separate CVE identifier might be created for the unfixed issue.
Ubuntu-Description: 
Notes: 
 jdstrand> actively being exploited against Oracle Java. As of 2013-01-12 no
  updates are available from Oracle. Users are advised to disable or uninstall
  the Oracle java 7 plugin
 jdstrand> vulnerability appears to be introduced in Java 7 and Java 6 does not
  seem affected
 jdstrand> IcedTea 7 is affected way but the reproducers currently don't work
  on Ubuntu. Users are advised to disable and/or uninstall the IcedTea plugin
  (regardless of version) as a precaution unless its use is strictly required.
 jdstrand> per mdeslaur, can't reproduce with icedtea-7-plugin on Ubuntu 12.04
  LTS and 12.10 or with icedtea6-plugin on 12.04 LTS. jdstrand could also not
  reproduce.
 jdstrand> per mdeslaur, reproducer works with Oracle Java 7u10 on Ubuntu 12.04
  LTS and 12.10. Confirmed to also work with 7u9.
 jdstrand> Fixed in IcedTea 2.2.3 and 2.3.4
Bugs: 
 https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2013-0422
Priority: high
Discovered-by:
Assigned-to: jdstrand

Patches_sun-java6:
upstream_sun-java6: needs-triage
hardy_sun-java6: ignored (upstream version is not redistributable)
lucid_sun-java6: DNE (removed from archive)
oneiric_sun-java6: DNE
precise_sun-java6: DNE
quantal_sun-java6: DNE
devel_sun-java6: DNE

Patches_sun-java5:
upstream_sun-java5: ignored (end of life)
hardy_sun-java5: ignored (upstream sun-java5 is EoL)
lucid_sun-java5: DNE
oneiric_sun-java5: DNE
precise_sun-java5: DNE
quantal_sun-java5: DNE
devel_sun-java5: DNE

Priority_openjdk-6: medium
Patches_openjdk-6:
upstream_openjdk-6: needs-triage
hardy_openjdk-6: ignored (reached end-of-life)
lucid_openjdk-6: not-affected
oneiric_openjdk-6: not-affected
precise_openjdk-6: not-affected
quantal_openjdk-6: not-affected
devel_openjdk-6: not-affected

Priority_icedtea-web: medium
Patches_icedtea-web:
upstream_icedtea-web: needs-triage
hardy_icedtea-web: DNE
lucid_icedtea-web: not-affected
oneiric_icedtea-web: not-affected
precise_icedtea-web: not-affected
quantal_icedtea-web: not-affected
devel_icedtea-web: not-affected

Patches_openjdk-7:
 upstream: http://icedtea.classpath.org/hg/release/icedtea7-2.2/raw-rev/9cc2d9873b77 (2.2)
 upstream: http://icedtea.classpath.org/hg/release/icedtea7-2.3/rev/f1922e9d9cb7 (2.3 #1)
 upstream: http://icedtea.classpath.org/hg/release/icedtea7-2.3/rev/e3c253d72ae5 (2.3 #2)
upstream_openjdk-7: released
hardy_openjdk-7: DNE
lucid_openjdk-7: DNE
oneiric_openjdk-7: released (7u9-2.3.4-0ubuntu1.11.10.1)
precise_openjdk-7: released (7u9-2.3.4-0ubuntu1.12.04.1)
quantal_openjdk-7: released (7u9-2.3.4-0ubuntu1.12.10.1)
devel_openjdk-7: released (7u9-2.3.4-1ubuntu1)

