Candidate: CVE-2009-0692
PublicDate: 2009-07-14
References: 
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-0692
 http://www.ubuntu.com/usn/usn-803-1
 https://www.isc.org/node/468
Description:
 Stack-based buffer overflow in the script_write_params method in
 client/dhclient.c in ISC DHCP dhclient 4.1 before 4.1.0p1, 4.0 before
 4.0.1p1, 3.1 before 3.1.2p1, 3.0, and 2.0 allows remote DHCP servers to
 execute arbitrary code via a crafted subnet-mask option.
Ubuntu-Description: 
Notes: 
 jdstrand> requires connecting to a malicious dhcp v4 server. Assigning
  high priority due to widespread use and frequency of roaming users connecting
  to untrusted dhcp servers
 jdstrand> CERT VU#410676
 jdstrand> this is only a DoS on Intrepid and later due to FORTIFY_SOURCE and
  can be considered 'low'. Jaunty also has an AppArmor profile that fully
  mitigates arbitrary code execution.
 jdstrand> dhcp v2 is not affected because it checks that lease -> options
  [DHO_SUBNET_MASK].len < sizeof lease -> address.iabuf. address.iabuf is
  the same size as netmask.iabuf. Furthermore, subnet_number() and
  broadcast_addr() (further below) properly check/use the length of netmask
Bugs: 
Priority: high
Discovered-by: Mandriva
Assigned-to: jdstrand

Patches_dhcp3:
Priority_dhcp3_intrepid: low (reduced to DoS by FORTIFY_SOURCE)
Priority_dhcp3_jaunty: low (reduced to DoS by FORTIFY_SOURCE and AppArmor)
Priority_dhcp3_karmic: low (reduced to DoS by FORTIFY_SOURCE and AppArmor)
upstream_dhcp3: not-affected (3.1.2p1)
dapper_dhcp3: released (3.0.3-6ubuntu7.1)
hardy_dhcp3: released (3.0.6.dfsg-1ubuntu9.1)
intrepid_dhcp3: released (3.1.1-1ubuntu2.1)
jaunty_dhcp3: released (3.1.1-5ubuntu8.1)
karmic_dhcp3: released (3.1.2-1ubuntu2)
devel_dhcp3: not-affected (3.1.3-1ubuntu3)

Patches_dhcp:
upstream_dhcp: needs-triage
dapper_dhcp: not-affected
hardy_dhcp: DNE
intrepid_dhcp: DNE
jaunty_dhcp: DNE
devel_dhcp: DNE
