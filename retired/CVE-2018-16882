PublicDateAtUSN: 2019-01-03
Candidate: CVE-2018-16882
PublicDate: 2019-01-03 16:29:00 UTC
References:
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-16882
 https://www.openwall.com/lists/oss-security/2018/12/18/6
 https://marc.info/?l=kvm&m=154514994222809&w=2
 https://usn.ubuntu.com/usn/usn-3871-1
 https://usn.ubuntu.com/usn/usn-3872-1
 https://usn.ubuntu.com/usn/usn-3871-3
 https://usn.ubuntu.com/usn/usn-3871-4
 https://usn.ubuntu.com/usn/usn-3878-1
 https://usn.ubuntu.com/usn/usn-3871-5
 https://usn.ubuntu.com/usn/usn-3878-2
Description:
 A use-after-free issue was found in the way the Linux kernel's KVM
 hypervisor processed posted interrupts when nested(=1) virtualization is
 enabled. In nested_get_vmcs12_pages(), in case of an error while processing
 posted interrupt address, it unmaps the 'pi_desc_page' without resetting
 'pi_desc' descriptor address, which is later used in
 pi_test_and_clear_on(). A guest user/process could use this flaw to crash
 the host kernel resulting in DoS or potentially gain privileged access to a
 system. Kernel versions before 4.14.91 and before 4.19.13 are vulnerable.
Ubuntu-Description:
 Cfir Cohen discovered that a use-after-free vulnerability existed in the
 KVM implementation of the Linux kernel, when handling interrupts in
 environments where nested virtualization is in use (nested KVM
 virtualization is not enabled by default in Ubuntu kernels). A local
 attacker in a guest VM could possibly use this to gain administrative
 privileges in a host machine.
Notes:
 tyhicks> Ubuntu kernels do not enable nested KVM virtualization by default and
  are unaffected by this flaw in the default configuration. To ensure that
  nested virtualization is not enabled, verify that the
  /sys/module/kvm_intel/parameters/nested file contains "N".
Bugs:
Priority: medium
Discovered-by: Cfir Cohen
Assigned-to: tyhicks

Patches_linux:
 break-fix: 5e2f30b756a37bd80c5b0471d0e10d769ab2eb9a c2dd5146e9fe1f22c77c1b011adf84eea0245806
upstream_linux: released (4.20)
precise/esm_linux: not-affected (3.0.0-12.20)
trusty_linux: not-affected (3.11.0-12.19)
trusty/esm_linux: not-affected (3.11.0-12.19)
xenial_linux: not-affected (4.2.0-16.19)
bionic_linux: released (4.15.0-44.47)
cosmic_linux: released (4.18.0-14.15)
devel_linux: not-affected (4.19.0-12.13)

Patches_linux-lts-trusty:
upstream_linux-lts-trusty: released (4.20)
precise/esm_linux-lts-trusty: not-affected (3.13.0-24.46~precise1)
trusty_linux-lts-trusty: DNE
trusty/esm_linux-lts-trusty: DNE
xenial_linux-lts-trusty: DNE
bionic_linux-lts-trusty: DNE
cosmic_linux-lts-trusty: DNE
devel_linux-lts-trusty: DNE

Patches_linux-goldfish:
upstream_linux-goldfish: released (4.20)
precise/esm_linux-goldfish: DNE
trusty_linux-goldfish: ignored (abandoned)
trusty/esm_linux-goldfish: DNE (trusty was ignored [abandoned])
xenial_linux-goldfish: ignored (end-of-life)
bionic_linux-goldfish: DNE
cosmic_linux-goldfish: DNE
devel_linux-goldfish: DNE

Patches_linux-grouper:
upstream_linux-grouper: released (4.20)
precise/esm_linux-grouper: DNE
trusty_linux-grouper: ignored (abandoned)
trusty/esm_linux-grouper: DNE (trusty was ignored [abandoned])
xenial_linux-grouper: DNE
bionic_linux-grouper: DNE
cosmic_linux-grouper: DNE
devel_linux-grouper: DNE

Patches_linux-maguro:
upstream_linux-maguro: released (4.20)
precise/esm_linux-maguro: DNE
trusty_linux-maguro: ignored (abandoned)
trusty/esm_linux-maguro: DNE (trusty was ignored [abandoned])
xenial_linux-maguro: DNE
bionic_linux-maguro: DNE
cosmic_linux-maguro: DNE
devel_linux-maguro: DNE

Patches_linux-mako:
upstream_linux-mako: released (4.20)
precise/esm_linux-mako: DNE
trusty_linux-mako: ignored (abandoned)
trusty/esm_linux-mako: DNE (trusty was ignored [abandoned])
xenial_linux-mako: ignored (abandoned)
bionic_linux-mako: DNE
cosmic_linux-mako: DNE
devel_linux-mako: DNE

Patches_linux-manta:
upstream_linux-manta: released (4.20)
precise/esm_linux-manta: DNE
trusty_linux-manta: ignored (abandoned)
trusty/esm_linux-manta: DNE (trusty was ignored [abandoned])
xenial_linux-manta: DNE
bionic_linux-manta: DNE
cosmic_linux-manta: DNE
devel_linux-manta: DNE

Patches_linux-flo:
upstream_linux-flo: released (4.20)
precise/esm_linux-flo: DNE
trusty_linux-flo: ignored (abandoned)
trusty/esm_linux-flo: DNE (trusty was ignored [abandoned])
xenial_linux-flo: ignored (abandoned)
bionic_linux-flo: DNE
cosmic_linux-flo: DNE
devel_linux-flo: DNE

Patches_linux-raspi2:
upstream_linux-raspi2: released (4.20)
precise/esm_linux-raspi2: DNE
trusty_linux-raspi2: DNE
trusty/esm_linux-raspi2: DNE
xenial_linux-raspi2: not-affected (4.2.0-1013.19)
bionic_linux-raspi2: released (4.15.0-1031.33)
cosmic_linux-raspi2: released (4.18.0-1009.11)
devel_linux-raspi2: not-affected (4.18.0-1009.11)

Patches_linux-lts-utopic:
upstream_linux-lts-utopic: released (4.20)
precise/esm_linux-lts-utopic: DNE
trusty_linux-lts-utopic: ignored (out of standard support)
trusty/esm_linux-lts-utopic: DNE (trusty was ignored [out of standard support])
xenial_linux-lts-utopic: DNE
bionic_linux-lts-utopic: DNE
cosmic_linux-lts-utopic: DNE
devel_linux-lts-utopic: DNE

Patches_linux-lts-vivid:
upstream_linux-lts-vivid: released (4.20)
precise/esm_linux-lts-vivid: DNE
trusty_linux-lts-vivid: ignored (out of standard support)
trusty/esm_linux-lts-vivid: DNE (trusty was ignored [out of standard support])
xenial_linux-lts-vivid: DNE
bionic_linux-lts-vivid: DNE
cosmic_linux-lts-vivid: DNE
devel_linux-lts-vivid: DNE

Patches_linux-lts-wily:
upstream_linux-lts-wily: released (4.20)
precise/esm_linux-lts-wily: DNE
trusty_linux-lts-wily: ignored (out of standard support)
trusty/esm_linux-lts-wily: DNE (trusty was ignored [out of standard support])
xenial_linux-lts-wily: DNE
bionic_linux-lts-wily: DNE
cosmic_linux-lts-wily: DNE
devel_linux-lts-wily: DNE

Patches_linux-lts-xenial:
upstream_linux-lts-xenial: released (4.20)
precise/esm_linux-lts-xenial: DNE
trusty_linux-lts-xenial: not-affected (4.4.0-13.29~14.04.1)
trusty/esm_linux-lts-xenial: not-affected (4.4.0-13.29~14.04.1)
xenial_linux-lts-xenial: DNE
bionic_linux-lts-xenial: DNE
cosmic_linux-lts-xenial: DNE
devel_linux-lts-xenial: DNE

Patches_linux-snapdragon:
upstream_linux-snapdragon: released (4.20)
precise/esm_linux-snapdragon: DNE
trusty_linux-snapdragon: DNE
trusty/esm_linux-snapdragon: DNE
xenial_linux-snapdragon: not-affected (4.4.0-1012.12)
bionic_linux-snapdragon: not-affected
cosmic_linux-snapdragon: DNE
devel_linux-snapdragon: not-affected

Patches_linux-aws:
upstream_linux-aws: released (4.20)
precise/esm_linux-aws: DNE
trusty_linux-aws: not-affected (4.4.0-1002.2)
trusty/esm_linux-aws: not-affected (4.4.0-1002.2)
xenial_linux-aws: not-affected (4.4.0-1001.10)
bionic_linux-aws: released (4.15.0-1032.34)
cosmic_linux-aws: released (4.18.0-1008.10)
devel_linux-aws: not-affected (4.18.0-1008.10)

Patches_linux-hwe:
upstream_linux-hwe: released (4.20)
precise/esm_linux-hwe: DNE
trusty_linux-hwe: DNE
trusty/esm_linux-hwe: DNE
xenial_linux-hwe: released (4.15.0-45.48~16.04.1)
bionic_linux-hwe: released (4.18.0-14.15~18.04.1)
cosmic_linux-hwe: DNE
devel_linux-hwe: DNE

Patches_linux-hwe-edge:
upstream_linux-hwe-edge: released (4.20)
precise/esm_linux-hwe-edge: DNE
trusty_linux-hwe-edge: DNE
trusty/esm_linux-hwe-edge: DNE
xenial_linux-hwe-edge: released (4.15.0-45.48~16.04.1)
bionic_linux-hwe-edge: not-affected (5.0.0-8.9~18.04.1)
cosmic_linux-hwe-edge: DNE
devel_linux-hwe-edge: DNE

Patches_linux-gke:
upstream_linux-gke: released (4.20)
precise/esm_linux-gke: DNE
trusty_linux-gke: DNE
trusty/esm_linux-gke: DNE
xenial_linux-gke: ignored (end-of-life)
bionic_linux-gke: DNE
cosmic_linux-gke: DNE
devel_linux-gke: DNE

Patches_linux-azure:
upstream_linux-azure: released (4.20)
precise/esm_linux-azure: DNE
trusty_linux-azure: released (4.15.0-1037.39~14.04.2)
trusty/esm_linux-azure: released (4.15.0-1037.39~14.04.2)
xenial_linux-azure: released (4.15.0-1037.39~16.04.1)
bionic_linux-azure: released (4.15.0-1037.39)
cosmic_linux-azure: released (4.18.0-1008.8)
devel_linux-azure: not-affected (4.18.0-1008.8)

Patches_linux-azure-edge:
upstream_linux-azure-edge: released (4.20)
precise/esm_linux-azure-edge: DNE
trusty_linux-azure-edge: DNE
trusty/esm_linux-azure-edge: DNE
xenial_linux-azure-edge: released (4.15.0-1037.39~16.04.1)
bionic_linux-azure-edge: released (4.15.0-1037.39)
cosmic_linux-azure-edge: DNE
devel_linux-azure-edge: DNE

Patches_linux-gcp:
upstream_linux-gcp: released (4.20)
precise/esm_linux-gcp: DNE
trusty_linux-gcp: DNE
trusty/esm_linux-gcp: DNE
xenial_linux-gcp: released (4.15.0-1027.28~16.04.1)
bionic_linux-gcp: released (4.15.0-1027.28)
cosmic_linux-gcp: released (4.18.0-1006.7)
devel_linux-gcp: not-affected (4.18.0-1006.7)

Patches_linux-kvm:
upstream_linux-kvm: released (4.20)
precise/esm_linux-kvm: DNE
trusty_linux-kvm: DNE
trusty/esm_linux-kvm: DNE
xenial_linux-kvm: not-affected (4.4.0-1004.9)
bionic_linux-kvm: released (4.15.0-1029.29)
cosmic_linux-kvm: released (4.18.0-1007.7)
devel_linux-kvm: not-affected (4.18.0-1007.7)

Patches_linux-euclid:
upstream_linux-euclid: released (4.20)
precise/esm_linux-euclid: DNE
trusty_linux-euclid: DNE
trusty/esm_linux-euclid: DNE
xenial_linux-euclid: not-affected (4.4.0-9019.20)
bionic_linux-euclid: DNE
cosmic_linux-euclid: DNE
devel_linux-euclid: DNE

Patches_linux-oem:
upstream_linux-oem: released (4.20)
precise/esm_linux-oem: DNE
trusty_linux-oem: DNE
trusty/esm_linux-oem: DNE
xenial_linux-oem: ignored (was needs-triage now end-of-life)
bionic_linux-oem: released (4.15.0-1033.38)
cosmic_linux-oem: released (4.15.0-1033.38)
devel_linux-oem: not-affected (4.15.0-1033.38)

Patches_linux-gcp-edge:
upstream_linux-gcp-edge: released (4.20)
precise/esm_linux-gcp-edge: DNE
trusty_linux-gcp-edge: DNE
trusty/esm_linux-gcp-edge: DNE
xenial_linux-gcp-edge: DNE
bionic_linux-gcp-edge: released (4.18.0-1006.7~18.04.1)
cosmic_linux-gcp-edge: DNE
devel_linux-gcp-edge: DNE

Patches_linux-aws-hwe:
upstream_linux-aws-hwe: released (4.20)
precise/esm_linux-aws-hwe: DNE
trusty_linux-aws-hwe: DNE
trusty/esm_linux-aws-hwe: DNE
xenial_linux-aws-hwe: released (4.15.0-1032.34~16.04.1)
bionic_linux-aws-hwe: DNE
cosmic_linux-aws-hwe: DNE
devel_linux-aws-hwe: DNE

Patches_linux-oracle:
upstream_linux-oracle: released (4.20)
precise/esm_linux-oracle: DNE
trusty_linux-oracle: DNE
trusty/esm_linux-oracle: DNE
xenial_linux-oracle: released (4.15.0-1008.10~16.04.1)
bionic_linux-oracle: released (4.15.0-1008.10)
cosmic_linux-oracle: not-affected
devel_linux-oracle: not-affected (4.15.0-1008.10)
