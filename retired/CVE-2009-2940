PublicDateAtUSN: 2009-10-22
Candidate: CVE-2009-2940
PublicDate: 2009-10-22
References: 
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-2940
 http://www.ubuntu.com/usn/usn-870-1
Description:
 The pygresql module 3.8.1 and 4.0 for Python does not properly support the
 PQescapeStringConn function, which might allow remote attackers to leverage
 escaping issues involving multibyte character encodings.
Ubuntu-Description: 
Notes: 
 jdstrand> 1:4.0-0ubuntu1 and higher has the fix
 jdstrand> affected versions have an escape_string() and escape_bytea() that
  uses PQescapeString() and PQescapeBytea() from PostgreSQL's libpq-fe.h.
  These are known to be problematic. The fix is to create pg_escape_string()
  and pg_escape_bytea() which use the safe PQescapeStringConn() and
  PQescapeByteaConn() functions, and then add them to the pgobj methods.
  Applications will have to be rewritten to use the new functions,
  specifically, something like this:
   cnx = pg.connect(...)
   ...
   escaped = pg.escape_string(str)

  to be:
   cnx = pg.connect(...)
   ...
   escaped = cnx.escape_string(str)

Bugs: 
Priority: medium
Discovered-by:
Assigned-to: jdstrand

Patches_pygresql:
 vendor: http://www.debian.org/security/2009/dsa-1911
upstream_pygresql: released (1:4.0-1)
dapper_pygresql: ignored (reached end-of-life)
hardy_pygresql: released (1:3.8.1-2ubuntu0.1)
intrepid_pygresql: released (1:3.8.1-3ubuntu0.1)
jaunty_pygresql: not-affected (1:4.0-0ubuntu1)
karmic_pygresql: not-affected
devel_pygresql: not-affected
