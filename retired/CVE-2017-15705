PublicDateAtUSN: 2018-09-17
Candidate: CVE-2017-15705
PublicDate: 2018-09-17 14:29:00 UTC
References:
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-15705
 https://www.openwall.com/lists/oss-security/2018/09/16/1
 https://usn.ubuntu.com/usn/usn-3811-1
 https://usn.ubuntu.com/usn/usn-3811-2
Description:
 A denial of service vulnerability was identified that exists in Apache
 SpamAssassin before 3.4.2. The vulnerability arises with certain unclosed
 tags in emails that cause markup to be handled incorrectly leading to scan
 timeouts. In Apache SpamAssassin, using HTML::Parser, we setup an object
 and hook into the begin and end tag event handlers In both cases, the
 "open" event is immediately followed by a "close" event - even if the tag
 *does not* close in the HTML being parsed. Because of this, we are missing
 the "text" event to deal with the object normally. This can cause carefully
 crafted emails that might take more scan time than expected leading to a
 Denial of Service. The issue is possibly a bug or design decision in
 HTML::Parser that specifically impacts the way Apache SpamAssassin uses the
 module with poorly formed html. The exploit has been seen in the wild but
 not believed to have been purposefully part of a Denial of Service attempt.
 We are concerned that there may be attempts to abuse the vulnerability in
 the future.
Ubuntu-Description:
Notes:
Bugs:
 http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=908969
 https://bugs.launchpad.net/ubuntu/+source/spamassassin/+bug/1796863
Priority: medium
Discovered-by:
Assigned-to: mdeslaur


Patches_spamassassin:
upstream_spamassassin: released (3.4.2-1)
precise/esm_spamassassin: released (3.3.2-2ubuntu1.2)
trusty_spamassassin: released (3.4.2-0ubuntu0.14.04.1)
trusty/esm_spamassassin: released (3.4.2-0ubuntu0.14.04.1)
xenial_spamassassin: released (3.4.2-0ubuntu0.16.04.1)
bionic_spamassassin: released (3.4.2-0ubuntu0.18.04.1)
cosmic_spamassassin: not-affected (3.4.2-1)
devel_spamassassin: not-affected (3.4.2-1)
